
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Websocket 后台</title>
</head>

<body>
    <div>
        <button id="js-send"> 发送</button>
    </div>
</body>

<script type="text/javascript">
// 客户端 - 管理员
// WebSocket对象一共支持四个消息事件: onopen, onmessage, onclose, onerror

//兼容 FireFox
var url = 'ws://192.168.0.212:2020';
let socket;
if ('WebSocket' in window) {
    socket = new WebSocket(url);
} else if ('MozWebSocket' in window) {
    socket = new MozWebSocket(url);
}

// 握手成功
socket.onopen = function(evt) {
    console.log('Connected');
    // console.log(evt);
};

// 当客户端收到服务端发来的消息时，会触发onmessage事件。 参数evt.data中包含传输过来的数据。
socket.onmessage = function(evt) {
    // var msg = evt.data;//获取消息
    // if (msg.length > 0) {
    //     console.log("Server said:\r\n" + msg);
    // }
};

// 关闭 WS 连接
socket.onclose = function(evt) {
    console.log('WebSocket Closed!');
};

// 出错处理
socket.onerror = function(evt) {
    console.log('WebSocket Error!');
};

/*其它*/
// 点击事件
var send = document.getElementById('js-send');
send.addEventListener('click', function() {
    // var msg = {a:'a',b:'b'};
    var msg = 'admin';
    socket.send(msg);
    console.log(msg);
});

</script>
</html>