(function($){HS.namespace('HS.page.header');HS.page.header.init=function(){this.custom();this.kffn();this.fastRegister();this.wh3();this.zdjkf();this.ctcflayer();this.gdrp();this.lolflayer();this.refreshMiniCart();this.to_steam();this.switchNavigation();};HS.page.header.zdjkf=function(){$(".kf_newGame .goTop").click(function(){$("html,body").animate({scrollTop:0})})};HS.page.header.refreshMiniCart=function(){$(".shop-cart").one("mouseenter",function(){HS.page.header.cart();return false})};HS.page.header.gdrp=function(){var _gd=$.cookie("gdpr_window");if(_gd){$(".header-perm").html("");$(".header-perm").hide()}else{$(".header-perm").show()}
$(".header-perm .readmore").on("click",function(){$(".gdrp-detail-warp").show()});$(".header-perm .confirm,.detail-btn a:first").on("click",function(){$(".header-perm").html("");$(".header-perm").hide();$(".gdrp-detail-warp").hide();$.cookie("gdpr_window",true,{expires:365,path:"/",domain:_GDPRDOMAIN?_GDPRDOMAIN:"igvault.com",secure:true,HttpOnly:true})});$(".detail-btn a:last").click(function(){$(".gdrp-detail-warp").hide()})};HS.page.header.isSubDomain=function(){var darr=document.domain.split(".");return(darr.length==3&&darr[0]!="member"&&isNaN(darr[0]))}();if(HS.page.header.isSubDomain){HS.login.setServicePath("")}
HS.page.header.add=function(g_id,num,csrf,gameid){var a=window.location.href;var root_path=a.getDomain();var add_url=_hs_page_shopping_add_url;$.ajax({type:"POST",cache:"false",url:add_url,data:{"goods_id":g_id,"num":num,_csrf:csrf,"gameid":gameid},success:function(response){var d=$.parseJSON(response);if(d.res=="success"){HS.page.header.cart();HS.page.dialog.show({title:" ",id:"addcarttips",width:500,callback:function(){setTimeout(function(){HS.util.dialog.close()},5000)}})}else{var msg=d.message;console.log(d.message);if(!msg){msg="Failed!Please contact customer service!"}
HS.page.showError(msg)}}})};HS.page.header.cart=function(){var mini_cart_url=typeof(_hs_page_shopping_minicart_url)!="undefined"?_hs_page_shopping_minicart_url:null;if(mini_cart_url!==null){$.getJSON(mini_cart_url+"?jsoncallback=?",function(json){if($(".shop-cart .shop-cart-box")){$("#cart_count").html(json.cart_count);$(".shop-cart .shop-cart-box").html(json.cart_content)}})}};HS.page.header.wh3=function(){if($(".icon-wh3").size()==0){return}
$(".icon-wh3").parent().bindHSUI("ElementHover",{hoverClass:"wh3-hover"})};HS.page.header.custom=function(){$(".input-place").bindHSUI("InputPlaceHolder");$(".btn-frame").bindHSUI("PopDialogWin");$(".pmd-box").bindHSUI("TextLeftMarqueen",{items:"nobr",loop:true});$(".dropdown").bindHSUI("ElementHover",{hoverClass:"down_hover"});$(".header").find(".menu-list-box-dropdown").bindHSUI("ElementHover",{hoverClass:"menu-list-box-hover"})
$(".header").find(".menu-list-box-dropdown").mouseover(function(){$(this).find('img.lazyload').each(function(i,o){if($(o).attr('src')!=$(o).attr('data-original')){$(o).attr('src',$(o).attr('data-original'));}});})};HS.page.header.kffn=function(){if(screen.width>1280){$("#floatTool").bindHSUI("FloatTool",{mainWidth:1200,minWidth:1200,baseTop:480,floatTop:10})}
$(".icon-close,.icon-pic").click(function(){$(this).parent().toggleClass("ft-kf-zk")});$(".dropdown-txt").bindHSUI("ElementHover",{hoverClass:"dropdown-txt-hover"})};$(function(){HS.page.header.init()});HS.page.header.favorite=function(goodsid){var add_favorite=_hs_page_favorite_url;if(goodsid){$.ajax({type:"post",data:{"goodsid":goodsid},url:add_favorite,dataType:"json",success:function(response){HS.page.alert(response.title)}})}else{HS.page.alert("参数缺失")}};HS.page.header.get_cb_plugins=function(){var browser=navigator.userAgent;var plugins="";for(i=0;i<navigator.plugins.length;i++){plugins+="Plugin Name: "+navigator.plugins[i].name+"  description: "+navigator.plugins[i].description+"|@|"}
$.ajax({cache:false,type:"post",url:"/browser/index",data:{"plugins":plugins,"browser":browser},dataType:"json"})};HS.page.header.init_pap_cookie=function(){var url=window.location.href;var Days=1;var exp=new Date();exp.setTime(exp.getTime()+Days*24*60*60*1000);if(url.indexOf("at_aid")>0){document.cookie="pap_cookie"+"="+escape("at_aid")+";expires="+exp.toGMTString()}else{if(url.indexOf("a_aid")>0){document.cookie="pap_cookie"+"="+escape("a_aid")+";expires="+exp.toGMTString()}}};HS.page.header.getCookie=function(name){var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");if(arr=document.cookie.match(reg)){return unescape(arr[2])}else{return null}};HS.page.header.sw_login=function(type,data){var csrfToken=$('meta[name="csrf-token"]').attr("content");$(".loading-layer").show();$.ajax({type:"post",data:{"type":type,"data":data,"_csrf":csrfToken},url:"/landingpage/steam_email_bind",dataType:"json",success:function(response){if(response.res=="emailbind"){$("#Email-bind,#util-overlayer").remove();$(document.body).append(response.data)}else{if(response.res=="email"){if(response.type=="verifi-failed"){$(".error_tip").remove();setTimeout('$(".email-error").bindHSUI("FloatErrorTipText",{tips:"'+response.data+'",timer:3,pos:"right"})',600)}else{if(response.type=="IGV-Acc"){$("#Email-bind,#util-overlayer,.loading-layer").remove();$(document.body).append(response.data)}else{if(response.type=="email-verifi-suc"){HS.page.header.check_steam_bind_email("send-email-link")}else{if(response.type=="send-email-link"){$("#Email-bind,#util-overlayer,.loading-layer").remove();$(document.body).append(response.data)}}}}}else{if(response.res=="login-validate"){$(".error_tip").remove();$.each(response.data,function(k,v){setTimeout('$(".cus_'+k+'_inp").bindHSUI("FloatErrorTipText",{tips:"'+v[0]+'",timer:3,pos:"right"})',600)})}else{if(response.res=="login-suc"||response.res=="close"){window.location.reload()}else{if(response.res=="sw_login"){$("#Email-bind,#util-overlayer").remove();$(document.body).append(response.data)}}}}}
$(".loading-layer").hide()}})};HS.page.header.check_steam_bind_email=function(type,data){var csrfToken=$('meta[name="csrf-token"]').attr("content");$(".loading-layer").show();$.ajax({type:"post",data:{"type":type,"data":data,"_csrf":csrfToken},url:_hs_page_url_to_steam,dataType:"json",success:function(response){if(response.res=="emailbind"){$("#Email-bind,#util-overlayer").remove();$(document.body).append(response.data)}else{if(response.res=="email"){if(response.type=="verifi-failed"){$(".error_tip").remove();setTimeout('$(".email-error").bindHSUI("FloatErrorTipText",{tips:"'+response.data+'",timer:3,pos:"right"})',600)}else{if(response.type=="IGV-Acc"){$("#Email-bind,#util-overlayer,.loading-layer").remove();$(document.body).append(response.data)}else{if(response.type=="email-verifi-suc"){HS.page.header.check_steam_bind_email("send-email-link")}else{if(response.type=="send-email-link"){$("#Email-bind,#util-overlayer,.loading-layer").remove();$(document.body).append(response.data)}}}}}else{if(response.res=="login-validate"){$(".error_tip").remove();$.each(response.data,function(k,v){setTimeout('$(".cus_'+k+'_inp").bindHSUI("FloatErrorTipText",{tips:"'+v[0]+'",timer:3,pos:"right"})',600)})}else{if(response.res=="login-suc"||response.res=="close"){window.location.reload()}}}}
$(".loading-layer").hide()}})};HS.page.header.to_steam=function(){if(typeof(_hs_page_url_to_steam)!="undefined"&&_hs_page_url_to_steam!=""){HS.page.header.check_steam_bind_email("bindemail")}
if(typeof(_hs_page_url_to_set_pwd)!="undefined"&&_hs_page_url_to_set_pwd!=""){HS.page.header.check_steam_acc_pwd("set-pwd-view")}};HS.page.header.check_steam_acc_pwd=function(type,data){$(".loading-layer").show();var csrf=$('meta[name="csrf-token"]').attr("content");if(type=="close"){$.ajax({type:"post",data:{"type":type,"data":data,"_csrf":csrf},url:_hs_page_url_to_set_pwd,dataType:"json",async:false,success:function(response){if(response.res=="close"){window.location.href=response.data}else{window.location.reload()}}})}else{$.ajax({type:"post",data:{"type":type,"data":data,"_csrf":csrf},url:_hs_page_url_to_set_pwd,dataType:"json",success:function(response){if(response.res=="set-pwd-view"){$(document.body).append(response.data)}else{if(response.res=="close"||response.res=="suc"){window.location.reload()}else{if(response.res=="validate-false"){$(".error_tip").remove();setTimeout('$(".inp_'+response.name+'").bindHSUI("FloatErrorTipText",{tips:"'+response.msg+'",timer:3,pos:"right"})',600)}}}
$(".loading-layer").hide()}})}};HS.page.header.loadimg=function(obj){};HS.page.header.ctcflayer=function(){if(screen.width>1486){$("#ctcflayer").bindHSUI("FloatTool",{mainWidth:1200,minWidth:1200,baseTop:510,floatTop:120})}
$("#ctcflayer .btn-close").click(function(){})};HS.page.header.lolflayer=function(){if(screen.width>1486){$("#lolflayer").bindHSUI("FloatTool",{mainWidth:1200,minWidth:1200,baseTop:600,floatTop:210})}};HS.page.header.isCustomerLoad=function(url){var code="";$.ajax({cache:true,url:url,async:false,dataType:"json",success:function(data){code=data}});return code};HS.page.header.refreshCaptcha=function(){$.ajax({url:_hs_page_url_verify_code,cache:false,data:{"refresh":1},success:function(data){var json=eval("("+data+")");$("#customerloginform-verifycode-image").attr("src",json.url)}})};HS.page.header.needsendmail=function(email,rememberMe,isPar){var sendemail=typeof(_hs_page_url_send_email)!="undefined"?_hs_page_url_send_email:null;if(sendemail!==null){$.getJSON(sendemail+"?jsoncallback=?&verify=email&cuw_email="+email+"&rememberMe="+rememberMe,function(json){if($("#ipmail")){if(isPar==1){$("#ipmail",window.parent.document).html(json.mail_content)}else{$("#ipmail").html(json.mail_content)}}
if(isPar==1){parent.HS.page.dialog.show({title:_hs_page_url_send_email_title,id:"ipmail",width:500,height:90,callback:function(){}})}else{HS.page.dialog.show({title:_hs_page_url_send_email_title,id:"ipmail",width:500,height:90,callback:function(){}})}})}};HS.page.header.cansendmail=function(){var sendemail=typeof(_hs_page_url_send_email_confirm)!="undefined"?_hs_page_url_send_email_confirm:null;if($(".tac").find("#mpass").length>0){return false}
if(sendemail!==null){if($("#mail_txt")){var _mail=$(".pdb-content").find("#mail_show").text();$("#mail_txt").text(_mail)}
var excludes=["_csrf"];$.each(excludes,function(i,v){excludes[i]='[name="'+v+'"]'});excludes=excludes.join(",");var urlparam=$($("#verify-security").prop("elements")).not(excludes).serialize();$.getJSON(sendemail+"?jsoncallback=?&"+urlparam,function(json){});HS.page.dialog.show({title:_hs_page_url_send_email_title,id:"mailsuccess",width:500,height:100,callback:function(){}})}};HS.page.header.fastRegister=function(){$("#formregister").on("submit",function(){$(":submit").attr("disabled",true).addClass("disabled")})}})(jQuery);HS.page.header.switchNavigation=function(){var winWidth=$(window).width();var hmdLeft=parseInt((winWidth-1200)/2+1);$('.header-menu-lf .hmd').css({"width":winWidth,"left":-hmdLeft+"px"});$('.hmd').parent('li').hover(function(){var itemWidth=$(this).width();var triangleLeft=itemWidth-27;$(this).find('.triangle').css('left',triangleLeft+'px').show();var index=$(this).index();$(this).find('.hmd').show().end().siblings('li').find('.hmd').hide();},function(){$(this).find('.hmd').hide().end().find('.triangle').hide();})}